webpackJsonp([66],{wUQI:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});e("4Xi4");var o=e("IH10"),i=e("E4LH"),l={data:function(){return{dataForm:{id:"",bizCustId:"",bizInfoId:"",entName:"",entCreditCode:"",entLegalOptName:"",entLegalOptMobile:"",wantLoanAmt:"",wantLoanLimt:"",payTypeDictId:""},dataRule:{entName:[{required:!0,message:"企业名称不能为空",trigger:"blur"}],entCreditCode:[{required:!0,message:"统一社会信用代码不能为空",trigger:"blur"},{validator:function(t,a,e){var o=a+"",i={},l="ABCDEFGHJKLMNPQRTUWXY".split(""),n=[1,3,9,27,19,26,16,17,20,29,25,13,8,24,10,30,28],r=/^[A-Z]$/,d=o.slice(0,o.length-1);o.split("");18!==o.length&&e(new Error("统一社会信用代码不合法")),!0===/[IOZVS]/.test(o)&&e(new Error("统一社会信用代码不合法")),!0!==/^((1[1239])|(5[1239])|(9[123])|(Y1))\d{6}[0-9ABCDEFGHJKLMNPQRTUWXY]{9}$/.test(d)&&e(new Error("统一社会信用代码不合法"));for(var s=0,p=l.length,m=10;s<p;s++,m++)i[l[s]]=m;for(var c=0,h=0,u=d.length;h<u;h++)!0===r.test(d[h])?c+=parseInt(i[d[h]])*n[h]:c+=parseInt(d[h])*n[h];var g,f=31-c%31;if(f>=10)if(31!=f){for(var L in i)if(i.hasOwnProperty(L)&&i[L]===f){g=L;break}}else g=0;else g=f;o[17]==g?e():e(new Error("统一社会信用代码不合法"))},trigger:"blur"}],entLegalOptName:[{required:!0,message:"法定代表人姓名不能为空",trigger:"blur"}],entLegalOptMobile:[{required:!0,message:"手机号码不能为空",trigger:"blur"},{validator:function(t,a,e){Object(i.b)(a)?e():e(new Error("手机号格式错误"))},trigger:"blur"}]},dataPostLoading:!1,followupVisible:!0,addLogVisible:!1,bizId:"",entName:"",entCreditCode:"",entLegalOptName:"",entLegalOptMobile:"",wantLoanAmt:"",wantLoanLimt:"",payTypeDictId:"",dataListLoading:!1,fpss:[],callTypes:[],dataLogListLoading:!1,dataLogList:[],payTypeDics:[],custInfo:[],pageIndex:1,pageSize:10,totalPage:0}},components:{Add:o.default},created:function(){var t=this;this.$http({url:this.$http.adornUrl("/biz/info/allpaytypes"),method:"get",params:this.$http.adornParams()}).then(function(a){var e=a.data;e&&200===e.code&&e.data&&(t.payTypeDics=e.data)})},methods:{init:function(t,a){this.followupVisible=!0,this.dataForm.bizCustId=t,this.bizId=a,this.getFpsOptions(),this.getCallTypeOptions(),this.getLogDetailDataInfo(),this.getDataInfo(),this.getLogDataInfo()},valueMoneyFormat:function(t,a){return(t.wantLoanAmt||0)/1e6},valueFollowUpStatusFormat:function(t,a){var e=t.bizCurrFollowUpStatusDictId,o="未定义";return this.fpss.forEach(function(t){t.id===e&&(o=t.value)}),o},valueFollowUpCallFormat:function(t,a){var e=t.followUpCallDictId,o="未定义";return this.callTypes.forEach(function(t){t.id===e&&(o=t.value)}),o},getFpsOptions:function(){var t=this;this.$http({url:this.$http.adornUrl("/biz/info/allfps"),method:"post"}).then(function(a){var e=a.data;e&&200===e.code&&e.data?t.fpss=e.data:t.fpss=[]})},getCallTypeOptions:function(){var t=this;this.$http({url:this.$http.adornUrl("/biz/info/allcalltypes"),method:"get",params:this.$http.adornParams()}).then(function(a){var e=a.data;e&&200===e.code&&e.data&&(t.callTypes=e.data)})},getLogDataInfo:function(){var t=this;this.dataLogListLoading=!0,this.$http({url:this.$http.adornUrl("/biz/infofuplog/list/"+this.bizId),method:"get",data:this.$http.adornParams()}).then(function(a){var e=a.data;e&&200===e.code&&e.data?t.dataLogList=e.data:t.dataLogList=[],t.dataLogListLoading=!1})},getLogDetailDataInfo:function(){var t=this;this.dataLogListLoading=!0,this.$http({url:this.$http.adornUrl("/biz/infodetail/info"),method:"post",data:this.$http.adornData({bizInfoId:this.bizId})}).then(function(a){var e=a.data;e&&200===e.code&&e.data&&(t.dataForm=e.data,t.dataForm.wantLoanAmt=(t.dataForm.wantLoanAmt||0)/1e6),t.dataLogListLoading=!1})},getDataInfo:function(){var t=this;this.dataListLoading=!0,this.$http({url:this.$http.adornUrl("/cust/getCustInfo"),method:"post",data:this.$http.adornParams({custId:this.dataForm.bizCustId})}).then(function(a){var e=a.data;console.log(e.data),e&&200===e.code?t.custInfo=e.data:t.custInfo="",t.dataListLoading=!1})},okHandle:function(){var t=this;this.dataPostLoading=!0,this.$http({url:this.$http.adornUrl("/biz/infodetail/"+(this.dataForm.id?"update":"save")),method:"post",data:this.$http.adornParams({id:this.dataForm.id||void 0,bizInfoId:this.bizId,wantLoanAmt:1e6*(this.dataForm.wantLoanAmt||0),wantLoanLimt:this.dataForm.wantLoanLimt,payTypeDictId:this.dataForm.payTypeDictId,entName:this.dataForm.entName,entCreditCode:this.dataForm.entCreditCode,entLegalOptName:this.dataForm.entLegalOptName,entLegalOptMobile:this.dataForm.entLegalOptMobile})}).then(function(a){var e=a.data;e&&200===e.code?t.$message.success("保存成功"):t.$message.error(e.msg),t.dataPostLoading=!1})},translateHandle:function(){var t=this;this.dataForm.bizCustId?this.$message.error("已经是平台用户，不能再转"):this.$refs.dataForm.validate(function(a){a&&(t.dataPostLoading=!0,t.$http({url:t.$http.adornUrl("/biz/infodetail/traslate"),method:"post",data:t.$http.adornParams({id:t.dataForm.id||void 0,bizInfoId:t.bizId,wantLoanAmt:1e6*(t.dataForm.wantLoanAmt||0),wantLoanLimt:t.dataForm.wantLoanLimt,payTypeDictId:t.dataForm.payTypeDictId,entName:t.dataForm.entName,entCreditCode:t.dataForm.entCreditCode,entLegalOptName:t.dataForm.entLegalOptName,entLegalOptMobile:t.dataForm.entLegalOptMobile})}).then(function(a){var e=a.data;e&&200===e.code?t.$message.success("保存成功"):t.$message.error("转化失败"),t.dataPostLoading=!1}))})},addHandle:function(){var t=this;this.addLogVisible=!0;var a=this.bizId;this.$nextTick(function(){t.$refs.add.init(a)})}}},n={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.dataPostLoading,expression:"dataPostLoading"}],staticClass:"mod-followup",staticStyle:{position:"relative","z-index":"2000"}},[e("el-dialog",{attrs:{title:"客户信息","close-on-click-modal":!1,visible:t.followupVisible},on:{"update:visible":function(a){t.followupVisible=a}}},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataListLoading,expression:"dataListLoading"}],staticStyle:{width:"100%"},attrs:{data:t.custInfo,border:""}},[t._e(),t._v(" "),t._e(),t._v(" "),e("el-table-column",{attrs:{prop:"mobile","header-align":"center",align:"center",label:"注册手机号"}}),t._v(" "),e("el-table-column",{attrs:{prop:"companyName","header-align":"center",align:"center",label:"公司名称"}}),t._v(" "),e("el-table-column",{attrs:{prop:"legalName","header-align":"center",align:"center",label:"法人姓名"}}),t._v(" "),e("el-table-column",{attrs:{prop:"requireAmount","header-align":"center",align:"center",width:"150","show-overflow-tooltip":!0,label:"贷款需求（万元）"}}),t._v(" "),e("el-table-column",{attrs:{prop:"requireLimit","header-align":"center",align:"center",width:"150","show-overflow-tooltip":!0,label:"期限（月）"}}),t._v(" "),e("el-table-column",{attrs:{prop:"followPerson","header-align":"center",align:"center",label:"跟进人"}}),t._v(" "),e("el-table-column",{attrs:{prop:"registerTime","header-align":"center",align:"center",width:"180",label:"注册时间"}})],1),t._v(" "),e("el-form",{attrs:{inline:!0}},[e("el-form-item",[e("div",[t._v("  ")])])],1),t._v(" "),e("el-form",{attrs:{inline:!0}},[e("el-form-item",[e("h5",[t._v("跟进记录")])])],1),t._v(" "),e("el-form",{attrs:{inline:!0}},[e("el-form-item",[t.isAuth("biz:infofuplog:save")?e("el-button",{attrs:{type:"success"},on:{click:function(a){t.addHandle()}}},[t._v("新增")]):t._e()],1)],1),t._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataLogListLoading,expression:"dataLogListLoading"}],staticStyle:{width:"100%"},attrs:{data:t.dataLogList,border:""}},[e("el-table-column",{attrs:{prop:"followUperName","header-align":"center",align:"center",label:"跟进人"}}),t._v(" "),e("el-table-column",{attrs:{prop:"followUpCallDictId","header-align":"center",align:"center",label:"电话接通情况",formatter:t.valueFollowUpCallFormat}}),t._v(" "),e("el-table-column",{attrs:{prop:"followUpCallDesp","header-align":"center",align:"center",width:"150","show-overflow-tooltip":!0,label:"详细描述"}}),t._v(" "),e("el-table-column",{attrs:{prop:"createdTime","header-align":"center",align:"center",width:"180",label:"创建时间"}})],1),t._v(" "),e("el-form",{attrs:{inline:!0}},[e("el-form-item",[e("div",[t._v("  ")])])],1),t._v(" "),e("el-form",{ref:"dataForm",attrs:{model:t.dataForm,rules:t.dataRule,"label-width":"150px","input-width":"100px"}},[e("el-form-item",[e("h5",[t._v("企业信息")])]),t._v(" "),e("el-form-item",{attrs:{label:"企业名称:",prop:"entName"}},[e("el-col",{attrs:{span:12}},[e("el-input",{attrs:{placeholder:"企业名称"},model:{value:t.dataForm.entName,callback:function(a){t.$set(t.dataForm,"entName",a)},expression:"dataForm.entName"}})],1)],1),t._v(" "),e("el-form-item",{attrs:{label:"统一社会信用代码:",prop:"entCreditCode"}},[e("el-col",{attrs:{span:12}},[e("el-input",{attrs:{placeholder:"统一社会信用代码"},model:{value:t.dataForm.entCreditCode,callback:function(a){t.$set(t.dataForm,"entCreditCode",a)},expression:"dataForm.entCreditCode"}})],1)],1),t._v(" "),e("el-form-item",{attrs:{label:"法定代表人姓名:",prop:"entLegalOptName"}},[e("el-col",{attrs:{span:12}},[e("el-input",{attrs:{placeholder:"法定代表人姓名"},model:{value:t.dataForm.entLegalOptName,callback:function(a){t.$set(t.dataForm,"entLegalOptName",a)},expression:"dataForm.entLegalOptName"}})],1)],1),t._v(" "),e("el-form-item",{attrs:{label:"手机号码",prop:"entLegalOptMobile"}},[e("el-col",{attrs:{span:12}},[e("el-input",{attrs:{placeholder:"手机号码"},model:{value:t.dataForm.entLegalOptMobile,callback:function(a){t.$set(t.dataForm,"entLegalOptMobile",a)},expression:"dataForm.entLegalOptMobile"}})],1)],1),t._v(" "),e("el-form-item",[e("h5",[t._v("需求信息")])]),t._v(" "),e("el-form-item",{attrs:{label:"需求金额（万元）",prop:"wantLoanAmt"}},[e("el-col",{attrs:{span:12}},[e("el-input",{attrs:{placeholder:"需求金额"},model:{value:t.dataForm.wantLoanAmt,callback:function(a){t.$set(t.dataForm,"wantLoanAmt",a)},expression:"dataForm.wantLoanAmt"}})],1)],1),t._v(" "),e("el-form-item",{attrs:{label:"需求期限（月）",prop:"wantLoanLimt"}},[e("el-col",{attrs:{span:12}},[e("el-input",{attrs:{placeholder:"需求期限"},model:{value:t.dataForm.wantLoanLimt,callback:function(a){t.$set(t.dataForm,"wantLoanLimt",a)},expression:"dataForm.wantLoanLimt"}})],1)],1),t._v(" "),e("el-form-item",{attrs:{label:"还款方式",prop:"payTypeDictId"}},[e("el-col",{attrs:{span:12}},[e("el-select",{attrs:{placeholder:"还款方式"},model:{value:t.dataForm.payTypeDictId,callback:function(a){t.$set(t.dataForm,"payTypeDictId",a)},expression:"dataForm.payTypeDictId"}},t._l(t.payTypeDics,function(t){return e("el-option",{key:t.id,attrs:{label:t.value,value:t.id}})}))],1)],1)],1),t._v(" "),e("el-form",{attrs:{inline:!0}},[e("el-form-item",[t.isAuth("biz:infodetail:save")?e("el-button",{attrs:{type:"success"},on:{click:function(a){t.okHandle()}}},[t._v("确认")]):t._e()],1)],1)],1),t._v(" "),t.addLogVisible?e("add",{ref:"add",on:{refreshDataList:t.getLogDataInfo}}):t._e()],1)},staticRenderFns:[]},r=e("vSla")(l,n,!1,null,null,null);a.default=r.exports}});