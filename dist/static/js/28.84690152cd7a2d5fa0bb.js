webpackJsonp([28,66],{AAfz:function(t,e,a){(t.exports=a("BkJT")(!1)).push([t.i,"\n.mod-followup {\n  position: relative;\n  z-index: 2000;\n}\n.v-modal {\n  z-index: 1999 !important;\n}\n",""])},L7hI:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("wUQI"),l=a("YDu6"),n=a("dVeB");l.default.component(n.Button.name,n.Button),l.default.component(n.Select.name,n.Select),l.default.component(n.Input.name,n.Input),l.default.component(n.Autocomplete.name,n.Autocomplete),l.default.component(n.DatePicker.name,n.DatePicker),l.default.component(n.Option.name,n.Option);var i={data:function(){return{dataForm:{bizAgentLevel:"",fps:"",bizName:"",bizMobile:"",sTime:"",eTime:""},followupVisible:!1,dateValue:{},productLineLevels:[],statusLevels:[],dataList:[],pageIndex:1,pageSize:10,totalPage:0,dataListLoading:!1}},components:{Followup:o.default},created:function(){this.getDataList(),this.getLevelOptions(),this.getStatusOptions()},methods:{setDate:function(t){if(t){var e=t[0],a=t[1];this.dataForm.sTime=e,this.dataForm.eTime=a}else this.dataForm.sTime="",this.dataForm.eTime=""},valueMoneyFormat:function(t,e){return(t.wantLoanAmt||0)/1e6},valueFollowUpStatusFormat:function(t,e){var a=t.bizCurrFollowUpStatusDictId,o="未定义";return this.fpss.forEach(function(t){t.id===a&&(o=t.value)}),o},getLevelOptions:function(){var t=this;this.$http({url:this.$http.adornUrl("/biz/info/allproduct"),method:"post"}).then(function(e){var a=e.data;a&&200===a.code&&a.data?t.productLineLevels=a.data:t.productLineLevels=[]})},getStatusOptions:function(){var t=this;this.$http({url:this.$http.adornUrl("/cust/getCustStatusDic"),method:"post"}).then(function(e){var a=e.data;a&&200===a.code&&a.data?t.statusLevels=a.data:t.statusLevels=[]})},getDataList:function(){var t=this;this.dataListLoading=!0,this.$http({url:this.$http.adornUrl("/cust/getCustList"),method:"post",data:this.$http.adornParams({page:this.pageIndex,limit:this.pageSize,mobile:this.dataForm.mobile,companyName:this.dataForm.companyName,legalName:this.dataForm.legalName,productLine:this.dataForm.productLine,status:this.dataForm.status,startDate:this.dataForm.sTime,endDate:this.dataForm.eTime})}).then(function(e){var a=e.data;a&&200===a.code&&a.data?(t.dataList=a.data.list,t.totalPage=a.data.totalCount):(t.dataList=[],t.totalPage=0),t.dataListLoading=!1})},sizeChangeHandle:function(t){this.pageSize=t,this.pageIndex=1,this.getDataList()},currentChangeHandle:function(t){this.pageIndex=t,this.getDataList()},followupHandle:function(t,e){var a=this;this.followupVisible=!0,this.$nextTick(function(){a.$refs.followup.init(t,e)})},handleCommand:function(t){var e=this;console.log(t),this.$http({url:this.$http.adornUrl("/cust/updateCustStatus"),method:"post",data:this.$http.adornParams({status:t.status,custId:t.custId})}).then(function(t){var a=t.data;a&&200===a.code&&e.getDataList()})}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"mod-log"},[a("el-form",{attrs:{inline:!0,model:t.dataForm},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.getDataList()}}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"注册手机号",clearable:""},model:{value:t.dataForm.mobile,callback:function(e){t.$set(t.dataForm,"mobile",e)},expression:"dataForm.mobile"}})],1),t._v(" "),a("el-form-item",[a("el-input",{attrs:{placeholder:"企业名称",clearable:""},model:{value:t.dataForm.companyName,callback:function(e){t.$set(t.dataForm,"companyName",e)},expression:"dataForm.companyName"}})],1),t._v(" "),a("el-form-item",[a("el-input",{attrs:{placeholder:"法定代表人",clearable:""},model:{value:t.dataForm.legalName,callback:function(e){t.$set(t.dataForm,"legalName",e)},expression:"dataForm.legalName"}})],1),t._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择名单来源",clearable:""},model:{value:t.dataForm.productLine,callback:function(e){t.$set(t.dataForm,"productLine",e)},expression:"dataForm.productLine"}},t._l(t.productLineLevels,function(t,e){return a("el-option",{key:e,attrs:{label:t,value:t}})}))],1),t._v(" "),a("el-form-item",[a("el-select",{attrs:{placeholder:"请选择跟进状态",clearable:""},model:{value:t.dataForm.status,callback:function(e){t.$set(t.dataForm,"status",e)},expression:"dataForm.status"}},t._l(t.statusLevels,function(t){return a("el-option",{key:t.id,attrs:{label:t.value,value:t.id}})}))],1),t._v(" "),a("el-form-item",[a("el-date-picker",{attrs:{type:"daterange","unlink-panels":"",format:"yyyy-MM-dd","start-placeholder":"开始日期","range-separator":"至","end-placeholder":"结束日期"},on:{change:t.setDate},model:{value:t.dateValue,callback:function(e){t.dateValue=e},expression:"dateValue"}})],1),t._v(" "),a("el-form-item",[a("el-button",{on:{click:function(e){t.getDataList()}}},[t._v("查询")])],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataListLoading,expression:"dataListLoading"}],staticStyle:{width:"100%"},attrs:{data:t.dataList,border:""}},[t._e(),t._v(" "),t._e(),t._v(" "),a("el-table-column",{attrs:{prop:"mobile","header-align":"center",align:"center",label:"注册手机号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"companyName","header-align":"center",align:"center",label:"公司名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"legalName","header-align":"center",align:"center",label:"法人姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"requireAmount","header-align":"center",align:"center",width:"150","show-overflow-tooltip":!0,label:"贷款需求（万元）"}}),t._v(" "),a("el-table-column",{attrs:{prop:"requireLimit","header-align":"center",align:"center",width:"150","show-overflow-tooltip":!0,label:"期限（月）"}}),t._v(" "),a("el-table-column",{attrs:{prop:"followStatus","header-align":"center",align:"center",label:"跟进状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-dropdown",{staticClass:"navdash",attrs:{trigger:"click"},on:{command:t.handleCommand}},[a("el-button",{attrs:{type:"primary"}},[t._v("\n            "+t._s(e.row.followStatus)),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},t._l(t.statusLevels,function(o){return a("el-dropdown-item",{key:o.id,attrs:{command:{status:o.id,custId:e.row.bizCustId}},domProps:{textContent:t._s(o.value)}})}))],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"productLine","header-align":"center",align:"center",width:"150",label:"名单来源"}}),t._v(" "),a("el-table-column",{attrs:{prop:"followPerson","header-align":"center",align:"center",label:"跟进人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"registerTime","header-align":"center",align:"center",width:"180",label:"注册时间"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"right","header-align":"center",align:"center",width:"150",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){t.followupHandle(e.row.bizCustId,e.row.bizInfoId)}}},[t._v("跟进")])]}}])})],1),t._v(" "),a("el-pagination",{attrs:{"current-page":t.pageIndex,"page-sizes":[10,20,50,100],"page-size":t.pageSize,total:t.totalPage,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.sizeChangeHandle,"current-change":t.currentChangeHandle}}),t._v(" "),t.followupVisible?a("followup",{ref:"followup"}):t._e()],1)},staticRenderFns:[]};var s=a("vSla")(i,r,!1,function(t){a("ifXI")},null,null);e.default=s.exports},ifXI:function(t,e,a){var o=a("AAfz");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);a("8bSs")("28383a52",o,!0)},wUQI:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("4Xi4");var o=a("IH10"),l=a("E4LH"),n={data:function(){return{dataForm:{id:"",bizCustId:"",bizInfoId:"",entName:"",entCreditCode:"",entLegalOptName:"",entLegalOptMobile:"",wantLoanAmt:"",wantLoanLimt:"",payTypeDictId:""},dataRule:{entName:[{required:!0,message:"企业名称不能为空",trigger:"blur"}],entCreditCode:[{required:!0,message:"统一社会信用代码不能为空",trigger:"blur"},{validator:function(t,e,a){var o=e+"",l={},n="ABCDEFGHJKLMNPQRTUWXY".split(""),i=[1,3,9,27,19,26,16,17,20,29,25,13,8,24,10,30,28],r=/^[A-Z]$/,s=o.slice(0,o.length-1);o.split("");18!==o.length&&a(new Error("统一社会信用代码不合法")),!0===/[IOZVS]/.test(o)&&a(new Error("统一社会信用代码不合法")),!0!==/^((1[1239])|(5[1239])|(9[123])|(Y1))\d{6}[0-9ABCDEFGHJKLMNPQRTUWXY]{9}$/.test(s)&&a(new Error("统一社会信用代码不合法"));for(var d=0,p=n.length,c=10;d<p;d++,c++)l[n[d]]=c;for(var m=0,u=0,h=s.length;u<h;u++)!0===r.test(s[u])?m+=parseInt(l[s[u]])*i[u]:m+=parseInt(s[u])*i[u];var g,f=31-m%31;if(f>=10)if(31!=f){for(var v in l)if(l.hasOwnProperty(v)&&l[v]===f){g=v;break}}else g=0;else g=f;o[17]==g?a():a(new Error("统一社会信用代码不合法"))},trigger:"blur"}],entLegalOptName:[{required:!0,message:"法定代表人姓名不能为空",trigger:"blur"}],entLegalOptMobile:[{required:!0,message:"手机号码不能为空",trigger:"blur"},{validator:function(t,e,a){Object(l.b)(e)?a():a(new Error("手机号格式错误"))},trigger:"blur"}]},dataPostLoading:!1,followupVisible:!0,addLogVisible:!1,bizId:"",entName:"",entCreditCode:"",entLegalOptName:"",entLegalOptMobile:"",wantLoanAmt:"",wantLoanLimt:"",payTypeDictId:"",dataListLoading:!1,fpss:[],callTypes:[],dataLogListLoading:!1,dataLogList:[],payTypeDics:[],custInfo:[],pageIndex:1,pageSize:10,totalPage:0}},components:{Add:o.default},created:function(){var t=this;this.$http({url:this.$http.adornUrl("/biz/info/allpaytypes"),method:"get",params:this.$http.adornParams()}).then(function(e){var a=e.data;a&&200===a.code&&a.data&&(t.payTypeDics=a.data)})},methods:{init:function(t,e){this.followupVisible=!0,this.dataForm.bizCustId=t,this.bizId=e,this.getFpsOptions(),this.getCallTypeOptions(),this.getLogDetailDataInfo(),this.getDataInfo(),this.getLogDataInfo()},valueMoneyFormat:function(t,e){return(t.wantLoanAmt||0)/1e6},valueFollowUpStatusFormat:function(t,e){var a=t.bizCurrFollowUpStatusDictId,o="未定义";return this.fpss.forEach(function(t){t.id===a&&(o=t.value)}),o},valueFollowUpCallFormat:function(t,e){var a=t.followUpCallDictId,o="未定义";return this.callTypes.forEach(function(t){t.id===a&&(o=t.value)}),o},getFpsOptions:function(){var t=this;this.$http({url:this.$http.adornUrl("/biz/info/allfps"),method:"post"}).then(function(e){var a=e.data;a&&200===a.code&&a.data?t.fpss=a.data:t.fpss=[]})},getCallTypeOptions:function(){var t=this;this.$http({url:this.$http.adornUrl("/biz/info/allcalltypes"),method:"get",params:this.$http.adornParams()}).then(function(e){var a=e.data;a&&200===a.code&&a.data&&(t.callTypes=a.data)})},getLogDataInfo:function(){var t=this;this.dataLogListLoading=!0,this.$http({url:this.$http.adornUrl("/biz/infofuplog/list/"+this.bizId),method:"get",data:this.$http.adornParams()}).then(function(e){var a=e.data;a&&200===a.code&&a.data?t.dataLogList=a.data:t.dataLogList=[],t.dataLogListLoading=!1})},getLogDetailDataInfo:function(){var t=this;this.dataLogListLoading=!0,this.$http({url:this.$http.adornUrl("/biz/infodetail/info"),method:"post",data:this.$http.adornData({bizInfoId:this.bizId})}).then(function(e){var a=e.data;a&&200===a.code&&a.data&&(t.dataForm=a.data,t.dataForm.wantLoanAmt=(t.dataForm.wantLoanAmt||0)/1e6),t.dataLogListLoading=!1})},getDataInfo:function(){var t=this;this.dataListLoading=!0,this.$http({url:this.$http.adornUrl("/cust/getCustInfo"),method:"post",data:this.$http.adornParams({custId:this.dataForm.bizCustId})}).then(function(e){var a=e.data;console.log(a.data),a&&200===a.code?t.custInfo=a.data:t.custInfo="",t.dataListLoading=!1})},okHandle:function(){var t=this;this.dataPostLoading=!0,this.$http({url:this.$http.adornUrl("/biz/infodetail/"+(this.dataForm.id?"update":"save")),method:"post",data:this.$http.adornParams({id:this.dataForm.id||void 0,bizInfoId:this.bizId,wantLoanAmt:1e6*(this.dataForm.wantLoanAmt||0),wantLoanLimt:this.dataForm.wantLoanLimt,payTypeDictId:this.dataForm.payTypeDictId,entName:this.dataForm.entName,entCreditCode:this.dataForm.entCreditCode,entLegalOptName:this.dataForm.entLegalOptName,entLegalOptMobile:this.dataForm.entLegalOptMobile})}).then(function(e){var a=e.data;a&&200===a.code?t.$message.success("保存成功"):t.$message.error(a.msg),t.dataPostLoading=!1})},translateHandle:function(){var t=this;this.dataForm.bizCustId?this.$message.error("已经是平台用户，不能再转"):this.$refs.dataForm.validate(function(e){e&&(t.dataPostLoading=!0,t.$http({url:t.$http.adornUrl("/biz/infodetail/traslate"),method:"post",data:t.$http.adornParams({id:t.dataForm.id||void 0,bizInfoId:t.bizId,wantLoanAmt:1e6*(t.dataForm.wantLoanAmt||0),wantLoanLimt:t.dataForm.wantLoanLimt,payTypeDictId:t.dataForm.payTypeDictId,entName:t.dataForm.entName,entCreditCode:t.dataForm.entCreditCode,entLegalOptName:t.dataForm.entLegalOptName,entLegalOptMobile:t.dataForm.entLegalOptMobile})}).then(function(e){var a=e.data;a&&200===a.code?t.$message.success("保存成功"):t.$message.error("转化失败"),t.dataPostLoading=!1}))})},addHandle:function(){var t=this;this.addLogVisible=!0;var e=this.bizId;this.$nextTick(function(){t.$refs.add.init(e)})}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.dataPostLoading,expression:"dataPostLoading"}],staticClass:"mod-followup",staticStyle:{position:"relative","z-index":"2000"}},[a("el-dialog",{attrs:{title:"客户信息","close-on-click-modal":!1,visible:t.followupVisible},on:{"update:visible":function(e){t.followupVisible=e}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataListLoading,expression:"dataListLoading"}],staticStyle:{width:"100%"},attrs:{data:t.custInfo,border:""}},[t._e(),t._v(" "),t._e(),t._v(" "),a("el-table-column",{attrs:{prop:"mobile","header-align":"center",align:"center",label:"注册手机号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"companyName","header-align":"center",align:"center",label:"公司名称"}}),t._v(" "),a("el-table-column",{attrs:{prop:"legalName","header-align":"center",align:"center",label:"法人姓名"}}),t._v(" "),a("el-table-column",{attrs:{prop:"requireAmount","header-align":"center",align:"center",width:"150","show-overflow-tooltip":!0,label:"贷款需求（万元）"}}),t._v(" "),a("el-table-column",{attrs:{prop:"requireLimit","header-align":"center",align:"center",width:"150","show-overflow-tooltip":!0,label:"期限（月）"}}),t._v(" "),a("el-table-column",{attrs:{prop:"followPerson","header-align":"center",align:"center",label:"跟进人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"registerTime","header-align":"center",align:"center",width:"180",label:"注册时间"}})],1),t._v(" "),a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("div",[t._v("  ")])])],1),t._v(" "),a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("h5",[t._v("跟进记录")])])],1),t._v(" "),a("el-form",{attrs:{inline:!0}},[a("el-form-item",[t.isAuth("biz:infofuplog:save")?a("el-button",{attrs:{type:"success"},on:{click:function(e){t.addHandle()}}},[t._v("新增")]):t._e()],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataLogListLoading,expression:"dataLogListLoading"}],staticStyle:{width:"100%"},attrs:{data:t.dataLogList,border:""}},[a("el-table-column",{attrs:{prop:"followUperName","header-align":"center",align:"center",label:"跟进人"}}),t._v(" "),a("el-table-column",{attrs:{prop:"followUpCallDictId","header-align":"center",align:"center",label:"电话接通情况",formatter:t.valueFollowUpCallFormat}}),t._v(" "),a("el-table-column",{attrs:{prop:"followUpCallDesp","header-align":"center",align:"center",width:"150","show-overflow-tooltip":!0,label:"详细描述"}}),t._v(" "),a("el-table-column",{attrs:{prop:"createdTime","header-align":"center",align:"center",width:"180",label:"创建时间"}})],1),t._v(" "),a("el-form",{attrs:{inline:!0}},[a("el-form-item",[a("div",[t._v("  ")])])],1),t._v(" "),a("el-form",{ref:"dataForm",attrs:{model:t.dataForm,rules:t.dataRule,"label-width":"150px","input-width":"100px"}},[a("el-form-item",[a("h5",[t._v("企业信息")])]),t._v(" "),a("el-form-item",{attrs:{label:"企业名称:",prop:"entName"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"企业名称"},model:{value:t.dataForm.entName,callback:function(e){t.$set(t.dataForm,"entName",e)},expression:"dataForm.entName"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"统一社会信用代码:",prop:"entCreditCode"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"统一社会信用代码"},model:{value:t.dataForm.entCreditCode,callback:function(e){t.$set(t.dataForm,"entCreditCode",e)},expression:"dataForm.entCreditCode"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"法定代表人姓名:",prop:"entLegalOptName"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"法定代表人姓名"},model:{value:t.dataForm.entLegalOptName,callback:function(e){t.$set(t.dataForm,"entLegalOptName",e)},expression:"dataForm.entLegalOptName"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"手机号码",prop:"entLegalOptMobile"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"手机号码"},model:{value:t.dataForm.entLegalOptMobile,callback:function(e){t.$set(t.dataForm,"entLegalOptMobile",e)},expression:"dataForm.entLegalOptMobile"}})],1)],1),t._v(" "),a("el-form-item",[a("h5",[t._v("需求信息")])]),t._v(" "),a("el-form-item",{attrs:{label:"需求金额（万元）",prop:"wantLoanAmt"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"需求金额"},model:{value:t.dataForm.wantLoanAmt,callback:function(e){t.$set(t.dataForm,"wantLoanAmt",e)},expression:"dataForm.wantLoanAmt"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"需求期限（月）",prop:"wantLoanLimt"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"需求期限"},model:{value:t.dataForm.wantLoanLimt,callback:function(e){t.$set(t.dataForm,"wantLoanLimt",e)},expression:"dataForm.wantLoanLimt"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"还款方式",prop:"payTypeDictId"}},[a("el-col",{attrs:{span:12}},[a("el-select",{attrs:{placeholder:"还款方式"},model:{value:t.dataForm.payTypeDictId,callback:function(e){t.$set(t.dataForm,"payTypeDictId",e)},expression:"dataForm.payTypeDictId"}},t._l(t.payTypeDics,function(t){return a("el-option",{key:t.id,attrs:{label:t.value,value:t.id}})}))],1)],1)],1),t._v(" "),a("el-form",{attrs:{inline:!0}},[a("el-form-item",[t.isAuth("biz:infodetail:save")?a("el-button",{attrs:{type:"success"},on:{click:function(e){t.okHandle()}}},[t._v("确认")]):t._e()],1)],1)],1),t._v(" "),t.addLogVisible?a("add",{ref:"add",on:{refreshDataList:t.getLogDataInfo}}):t._e()],1)},staticRenderFns:[]},r=a("vSla")(n,i,!1,null,null,null);e.default=r.exports}});